<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">


    <title>ArkaTrade-admin</title>

    <!-- Favicons -->
    <link href="./img/arka.webp" rel="icon">
    <link href="./img/apple-touch-icon.webp" rel="apple-touch-icon">

    <!-- Google Fonts -->
    <link href="./vendor/fonts/gfonts.css" rel="stylesheet">
    <!-- Vendor CSS Files -->
    <link href="./vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="./vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">

    <!-- Template Main CSS File -->
    <link href="./css/stylehome.css" rel="stylesheet">
    <link href="./css/headerfooter.css" rel="stylesheet">






</head>

<body>

    <main id="main">

        <section id="blog" style="overflow: auto;" class="blog">
            <div class="container"  data-aos="fade-up">

                <div class="section-title" data-aos="fade-up">
                    <h2><strong>AdminPanel</strong></h2>
                </div>




                <!--Add Countries-->
                <article class="entry">
                    <h2 class="entry-title">
                        Home-Flags
                    </h2>


                    <form id="countryForm">
                        <div class="row" style="display: flex; align-items: center; gap: 10px;">
                            <label for="cont" style="margin-right: 10px; white-space: nowrap;">Choose Country:</label>
                            <select name="cont" id="cont" style="flex: 1;"></select>
                            <button type="submit" class="btn btn-primary btn-sm" style="padding: 5px 10px; font-size: 0.75em;">Add</button>
                        </div>
                    </form>
                    

                    <table class="table" id="countriesTable">
                        <thead>
                            <tr>
                                <th scope="col">Country</th>
                                <th scope="col">Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Data rows will be populated here -->
                        </tbody>
                    </table>
                    
                    

                </article><!-- End  entry -->
                <!--------------------------------------------------------------------------------------------------------------------------------------------------------->





                <!--Contact Phones-->
                <article class="entry">
                    <h2 class="entry-title">
                        Contact-Us Phones
                    </h2>
                    <div class="entry-content">

                        <form id="phoneForm">
                            <label for="phone">Add Phone:</label>
                            <input type="text" id="phone" name="phone">
                            <button type="submit" class="btn btn-primary" >Add</button>
                        </form>
                   

                        <table class="table" id="phoneTableBody">
                            <thead>
                                <tr>
                                    <th scope="col">Phone</th>
                                    <th scope="col">Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Rows will be inserted here by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </article><!-- End  entry -->
                <!--------------------------------------------------------------------------------------------------------------------------------------------------------->






                <!--Contact Mails-->
                <article class="entry">
                    <h2 class="entry-title">
                        Contact-Us mails
                    </h2>
                    <div class="entry-content">


                        <form id="mailForm">
                            <label for="mail">Add Mail:</label>
                            <input type="text" id="mail" name="mail">
                            <button type="submit" class="btn btn-primary">Add</button>
                        </form>
                     

                        <table class="table" id="mailTableBody">
                            <thead>
                                <tr>
                                    <th scope="col">Mail</th>
                                    <th scope="col">Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Rows will be inserted here by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </article><!-- End  entry -->
                <!--------------------------------------------------------------------------------------------------------------------------------------------------------->





                <!--Contact Locations-->
                   <article class="entry">
                    <h2 class="entry-title">
                        Contact-Us locations
                    </h2>
                    <div class="entry-content">

                        <form id="locationForm">
                            <label for="location">Add Location:</label>
                            <input type="text" id="location" name="location">
                            <button type="submit" class="btn btn-primary">Add</button>
                        </form>


                        <table class="table" id="locationTableBody">
                            <thead>
                                <tr>
                                    <th scope="col">Location</th>
                                    <th scope="col">Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Rows will be inserted here by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </article><!-- End  entry -->
                <!--------------------------------------------------------------------------------------------------------------------------------------------------------->





                <!--Add Images-->
                <article class="entry">

                    <h2 class="entry-title">
                        Images
                    </h2>

                    <div class="entry-content">
                        <form id="imageUploadForm" onsubmit="uploadImage(); return false;" enctype="multipart/form-data">
                            <div class="form-group">
                                <label for="department">Choose Department:</label>
                                <select name="dept" id="dept">
                                    <option value="gallery">Gallery</option>
                                    <option value="Products">Products</option>
                                    <option value="brouj">brouj</option>
                                    <option value="barakat">barakat</option>
                                </select>
                                <label for="images">Choose images:</label>
                                <input type="file" name="images" class="form-control-file" id="images" multiple> 
                            </div>
                            <button type="submit" class="btn btn-primary" style="margin-top:2%">Upload</button>
                        </form>
                        

                        <table class="table" id="imageTable">
                            <thead>
                                <tr>
                                    <th scope="col" style="vertical-align: middle; text-align: center;">Image</th>
                                    <th scope="col" style="vertical-align: middle; text-align: center;">Department</th>
                                    <th scope="col"></th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Rows will be added here dynamically -->
                            </tbody>
                        </table>


                    </div>

                </article><!-- End entry -->
                <!--------------------------------------------------------------------------------------------------------------------------------------------------------->

               


            </div>
        </section><!-- End Blog Section -->

    </main><!-- End #main -->



      <!-- Vendor JS Files -->
  <script src="./vendor/aos/aos.js"></script>
  <script src="./vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="./vendor/glightbox/js/glightbox.min.js"></script>
  <script src="./vendor/isotope-layout/isotope.pkgd.min.js"></script>
  <script src="./vendor/swiper/swiper-bundle.min.js"></script>
  <script src="./vendor/waypoints/noframework.waypoints.js"></script>
  <!-- Template Main JS File -->
    <script src="./js/main.js"></script>
    <script src='./vendor/jquery/jquery.min.js'></script>  
    <script src='./js/scrollreveal.js'></script>
    <script src="./js/broj.js"></script>
    <!-- Translation Script -->


<script>
function uploadImage() {
    var fileInput = document.getElementById('images');
    var deptSelect = document.getElementById('dept');

    if (fileInput.files.length > 0) {
        var formData = new FormData();

        // Counter for asynchronous blob conversion
        var imagesProcessed = 0;

        for (var i = 0; i < fileInput.files.length; i++) {
            // Read each file as an image
            (function(file) {
                var reader = new FileReader();
                reader.onload = function (e) {
                    var image = new Image();
                    image.onload = function () {
                        // Create a canvas and get the context
                        var canvas = document.createElement('canvas');
                        var ctx = canvas.getContext('2d');

                        // Set canvas size to image size
                        canvas.width = image.width;
                        canvas.height = image.height;

                        // Draw the image onto the canvas without rotation
                        ctx.drawImage(image, 0, 0, image.width, image.height);

                        // Convert the canvas to a blob and add to formData
                        canvas.toBlob(function (blob) {
                            var newFile = new File([blob], file.name, {
                                type: 'image/jpeg',
                                lastModified: Date.now()
                            });
                            formData.append('images[]', newFile);

                            // Check if all files have been processed
                            imagesProcessed++;
                            if (imagesProcessed === fileInput.files.length) {
                                formData.append('dept', deptSelect.value);
                                sendFormData(formData); // Send form data after all images are processed
                            }
                        }, 'image/jpeg');
                    };
                    image.src = e.target.result;
                };
                reader.readAsDataURL(file);
            })(fileInput.files[i]);
        }
    } else {
        console.log('No file selected');
    }
}
function sendFormData(formData) {
    fetch('https://arkatrade.000webhostapp.com/phpapi/insertimage.php', {
        method: 'POST',
        body: formData
    }).then(response => {
        if (response.ok) {
            return response.text();
        }
        throw new Error('Network response was not ok.');
    }).then(data => {
        console.log('Success:', data);
        window.location.reload();
        // Handle the successful response
    }).catch(error => {
        console.error('Error:', error);
    });
}

</script>


<script>
    function loadimages() {
        fetch('https://arkatrade.000webhostapp.com/phpapi/getimages.php')
        .then(response => response.json())
        .then(data => {
            const tableBody = document.getElementById('imageTable').querySelector('tbody');
            data.forEach(item => {
                const row = document.createElement('tr');

                // Creating the image cell
                const imgCell = document.createElement('td');
                imgCell.style.textAlign = 'center';
                const img = new Image(100, 100); // width, height
                img.src = 'https://arkatrade.000webhostapp.com/phpapi/' + item.FilePath; // Update with the correct path
                img.className = 'img-fluid';
                img.loading = 'lazy'; // Adding lazy loading attribute
                imgCell.appendChild(img);

                // Creating the department cell
                const deptCell = document.createElement('td');
                deptCell.style.textAlign = 'center';
                deptCell.textContent = item.dept;

                // Creating the delete button cell
                const deleteCell = document.createElement('td');
                deleteCell.style.textAlign = 'center';
                const deleteButton = document.createElement('button');
                deleteButton.type = 'button';
                deleteButton.name = 'fileName';
                deleteButton.value = item.FilePath;
                deleteButton.className = 'btn btn-danger';
                deleteButton.textContent = 'Delete';
                deleteButton.onclick = function() { deleteImage(item.FilePath); };
                deleteCell.appendChild(deleteButton);

                // Appending cells to the row
                row.appendChild(imgCell);
                row.appendChild(deptCell);
                row.appendChild(deleteCell);

                // Appending the row to the table body
                tableBody.appendChild(row);
            });
        })
        .catch(error => console.error('Error:', error));
    }

    document.addEventListener('DOMContentLoaded', loadimages);

    function deleteImage(filePath) {
        if (confirm("Are you sure you want to delete this image?")) {
            fetch('https://arkatrade.000webhostapp.com/phpapi/deleteimage.php', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: 'fileName=' + encodeURIComponent(filePath)
            })
            .then(response => {
                if (response.ok) {
                    window.location.reload();
                }
                throw new Error('Network response was not ok.');
            })
            .then(data => {
                window.location.reload();
            })
            .catch(error => {
                console.error('Error:', error);
                window.location.reload();
            });
        }
    }
</script>



<!--------------------------------------------------------------------------------------------------------------------------------------------------------->


    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const selectElement = document.getElementById('cont');
            fetch('https://arkatrade.000webhostapp.com/phpapi/fetch_countries.php') // Replace with the actual path to your PHP script
                .then(response => response.json())
                .then(data => {
                    data.forEach(item => {
                        let option = new Option(item.countryname, item.countryname);
                        selectElement.add(option);
                    });
                })
                .catch(error => console.error('Error:', error));
        });
        </script>


<script>
    document.getElementById('countryForm').addEventListener('submit', function(e) {
        e.preventDefault(); // Prevents the default form submission

        // Fetch selected country
        var selectedCountry = document.getElementById('cont').value;

        // AJAX request to server-side script
        var xhr = new XMLHttpRequest();
        xhr.open('POST', 'https://arkatrade.000webhostapp.com/phpapi/update_countries.php', true);
        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');

        xhr.onload = function() {
            console.log(this.responseText);
            window.location.reload();
        };

        // Sending the selected country to the server
        xhr.send('country=' + encodeURIComponent(selectedCountry));
    });
</script>



<script>
    function loadCountries() {
        var xhr = new XMLHttpRequest();
        xhr.open('GET', 'https://arkatrade.000webhostapp.com/phpapi/fetch_addedcountries.php', true);
    
        xhr.onload = function() {
            if (this.status === 200) {
                var countries = JSON.parse(this.responseText);
                var table = document.getElementById('countriesTable').getElementsByTagName('tbody')[0];

                countries.forEach(function(country) {
                    var row = table.insertRow();
                    var cell1 = row.insertCell(0);
                    var cell2 = row.insertCell(1);
    
                    cell1.innerHTML = country.countryname;
                    cell2.innerHTML = "<button onclick='confirmDelete(\"" + country.countryname + "\", this.parentNode.parentNode)' class='btn btn-danger'>Delete</button>";
                });
            } else {
                console.error("Failed to load countries: " + this.status);
            }
        };

        xhr.onerror = function() {
            console.error("Request failed");
        };
    
        xhr.send();
    }
    
    document.addEventListener('DOMContentLoaded', loadCountries);

    function confirmDelete(countryname, rowElement) {
        if (confirm("Are you sure you want to delete " + countryname + "?")) {
            deleteCountry(countryname, rowElement);
        }
    }

    function deleteCountry(countryname, rowElement) {
        var xhr = new XMLHttpRequest();
        xhr.open('POST', 'https://arkatrade.000webhostapp.com/phpapi/removecountry.php', true);
        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
        xhr.send('countryname=' + encodeURIComponent(countryname));   
        xhr.onreadystatechange = function() {
            if (this.readyState === XMLHttpRequest.DONE) {
                if (this.status === 200) {
                    rowElement.remove();                   
                } else {
                    console.error("Failed to delete country: " + this.status);
                }
            }
        };
        window.location.reload();
       
    }
</script>


<!--------------------------------------------------------------------------------------------------------------------------------------------------------->


<script>
    document.getElementById('phoneForm').addEventListener('submit', function(e) {
        e.preventDefault(); // Prevents default form submission

        var phone = document.getElementById('phone').value;
        var xhr = new XMLHttpRequest();
        xhr.open('POST', 'https://arkatrade.000webhostapp.com/phpapi/insertphone.php', true);
        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
        xhr.onload = function() {
            if (this.status == 200) {
                console.log(this.responseText); // Handle the response here
            }
        };
        xhr.send('phone=' + encodeURIComponent(phone));
        window.location.reload();
    });
</script>



<script>
    function loadphones() {
        var xhr = new XMLHttpRequest();
        xhr.open('GET', 'https://arkatrade.000webhostapp.com/phpapi/getphones.php', true);
    
        xhr.onload = function() {
            if (this.status === 200) {
                var phones = JSON.parse(this.responseText);
                var table = document.getElementById('phoneTableBody').getElementsByTagName('tbody')[0];

                phones.forEach(function(phone) {
                    var row = table.insertRow();
                    var cell1 = row.insertCell(0);
                    var cell2 = row.insertCell(1);
    
                    cell1.innerHTML = phone.phone;
                    cell2.innerHTML = "<button onclick='confirmDeletephone(\"" + phone.phone + "\", this.parentNode.parentNode)' class='btn btn-danger'>Delete</button>";
                });
            } else {
                console.error("Failed to load phones: " + this.status);
            }
        };

        xhr.onerror = function() {
            console.error("Request failed");
        };
    
        xhr.send();
        
    }


    document.addEventListener('DOMContentLoaded', loadphones);

    function confirmDeletephone(phone, rowElement) {
        if (confirm("Are you sure you want to delete " + phone + "?")) {
            deletephone(phone, rowElement);
        }
    }

    function deletephone(phone, rowElement) {
        var xhr = new XMLHttpRequest();
        xhr.open('POST', 'https://arkatrade.000webhostapp.com/phpapi/deletephone.php', true);
        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
        xhr.send('phone=' + encodeURIComponent(phone));   
        xhr.onreadystatechange = function() {
            if (this.readyState === XMLHttpRequest.DONE) {
                if (this.status === 200) {
                    rowElement.remove();                   
                } else {
                    console.error("Failed to delete phone: " + this.status);
                }
            }
        };
        window.location.reload();
       
    }
</script>


<!--------------------------------------------------------------------------------------------------------------------------------------------------------->


<script>
    document.getElementById('mailForm').addEventListener('submit', function(e) {
        e.preventDefault(); // Prevents default form submission

        var mail = document.getElementById('mail').value;
        var xhr = new XMLHttpRequest();
        xhr.open('POST', 'https://arkatrade.000webhostapp.com/phpapi/insertmail.php', true);
        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
        xhr.onload = function() {
            if (this.status == 200) {
                console.log(this.responseText); // Handle the response here
            }
        };
        xhr.send('mail=' + encodeURIComponent(mail));
        window.location.reload();
    });
</script>



<script>
    function loadmails() {
        var xhr = new XMLHttpRequest();
        xhr.open('GET', 'https://arkatrade.000webhostapp.com/phpapi/getmails.php', true);
    
        xhr.onload = function() {
            if (this.status === 200) {
                var mails = JSON.parse(this.responseText);
                var table = document.getElementById('mailTableBody').getElementsByTagName('tbody')[0];

                mails.forEach(function(mail) {
                    var row = table.insertRow();
                    var cell1 = row.insertCell(0);
                    var cell2 = row.insertCell(1);
    
                    cell1.innerHTML = mail.email;
                    cell2.innerHTML = "<button onclick='confirmDeletemail(\"" + mail.email + "\", this.parentNode.parentNode)' class='btn btn-danger'>Delete</button>";
                });
            } else {
                console.error("Failed to load mails: " + this.status);
            }
        };

        xhr.onerror = function() {
            console.error("Request failed");
        };
    
        xhr.send();
        
    }


    document.addEventListener('DOMContentLoaded', loadmails);

    function confirmDeletemail(mail, rowElement) {
        if (confirm("Are you sure you want to delete " + mail + "?")) {
            deletemail(mail, rowElement);
        }
    }

    function deletemail(mail, rowElement) {
        var xhr = new XMLHttpRequest();
        xhr.open('POST', 'https://arkatrade.000webhostapp.com/phpapi/deletemail.php', true);
        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
        xhr.send('mail=' + encodeURIComponent(mail));   
        xhr.onreadystatechange = function() {
            if (this.readyState === XMLHttpRequest.DONE) {
                if (this.status === 200) {
                    rowElement.remove();                   
                } else {
                    console.error("Failed to delete mail: " + this.status);
                }
            }
        };
        window.location.reload();
       
    }
</script>


<!--------------------------------------------------------------------------------------------------------------------------------------------------------->



<script>
    document.getElementById('locationForm').addEventListener('submit', function(e) {
        e.preventDefault(); // Prevents default form submission

        var location = document.getElementById('location').value;
        var xhr = new XMLHttpRequest();
        xhr.open('POST', 'https://arkatrade.000webhostapp.com/phpapi/insertlocation.php', true);
        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
        xhr.onload = function() {
            if (this.status == 200) {
                console.log(this.responseText); // Handle the response here
            }
        };
        xhr.send('location=' + encodeURIComponent(location));
        window.location.reload();
    });
</script>



<script>
    function loadlocations() {
        var xhr = new XMLHttpRequest();
        xhr.open('GET', 'https://arkatrade.000webhostapp.com/phpapi/getlocations.php', true);
    
        xhr.onload = function() {
            if (this.status === 200) {
                var locations = JSON.parse(this.responseText);
                var table = document.getElementById('locationTableBody').getElementsByTagName('tbody')[0];

                locations.forEach(function(location) {
                    var row = table.insertRow();
                    var cell1 = row.insertCell(0);
                    var cell2 = row.insertCell(1);
    
                    cell1.innerHTML = location.location;
                    cell2.innerHTML = "<button onclick='confirmDeletelocation(\"" + location.location + "\", this.parentNode.parentNode)' class='btn btn-danger'>Delete</button>";
                });
            } else {
                console.error("Failed to load locations: " + this.status);
            }
        };

        xhr.onerror = function() {
            console.error("Request failed");
        };
    
        xhr.send();
        
    }


    document.addEventListener('DOMContentLoaded', loadlocations);

    function confirmDeletelocation(location, rowElement) {
        if (confirm("Are you sure you want to delete " + location + "?")) {
            deletelocation(location, rowElement);
        }
    }

    function deletelocation(location, rowElement) {
        var xhr = new XMLHttpRequest();
        xhr.open('POST', 'https://arkatrade.000webhostapp.com/phpapi/deletelocation.php', true);
        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
        xhr.send('location=' + encodeURIComponent(location));   
        xhr.onreadystatechange = function() {
            if (this.readyState === XMLHttpRequest.DONE) {
                if (this.status === 200) {
                    rowElement.remove();                   
                } else {
                    console.error("Failed to delete location: " + this.status);
                }
            }
        };
        window.location.reload();
       
    }
</script>


<!--------------------------------------------------------------------------------------------------------------------------------------------------------->
  
</body>

</html>
